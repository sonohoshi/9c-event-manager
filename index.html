<!DOCTYPE html>
<html>
<head>
    <title>Document and Event JSON Generator</title>
    <style>
        .content {
            margin-top: 20px;
        }
        pre {
            white-space: pre-line;
            border: 1px solid #ccc;
            padding: 10px;
            user-select: all;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Document and Event JSON Generator</h1>

    <button onclick="toggleSection('markdownSection')">Markdown Converter</button>
    <button onclick="toggleSection('eventSection')">Event JSON Generator</button>
    <button onclick="toggleSection('eventToolSection')">Event JSON Modifier</button>

    <div id="markdownSection" class="content hidden">
        <input type="file" id="fileInput">
        <pre id="outputText"></pre>
        <p>Select the above text and copy it using right click or keyboard shortcuts.</p>
    </div>

    <div id="eventSection" class="content hidden">
        <label for="priorityInput">Priority:</label>
        <input type="number" id="priorityInput" placeholder="우선순위"><br><br>

        <label for="bannerImageInput">Banner Image Name:</label>
        <input type="file" id="bannerImageInput" accept="image/*"><br><br>

        <label for="popupImageInput">Popup Image Name:</label>
        <input type="file" id="popupImageInput" accept="image/*"><br><br>

        <label for="useDateTime">Use Date and Time:</label>
        <input type="checkbox" id="useDateTime"><br><br>

        <label for="beginDateTimeInput">Begin Date and Time:</label>
        <input type="datetime-local" id="beginDateTimeInput"><br><br>

        <label for="endDateTimeInput">End Date and Time:</label>
        <input type="datetime-local" id="endDateTimeInput"><br><br>

        <label for="urlInput">URL:</label>
        <input type="text" id="urlInput" placeholder="URL"><br><br>

        <label for="useAgentAddress">Use Agent Address:</label>
        <input type="checkbox" id="useAgentAddress"><br><br>

        <label for="descriptionInput">Description:</label>
        <input type="text" id="descriptionInput" placeholder="설명"><br><br>

        <button id="generateButton">JSON 생성</button>

        <h2>JSON 결과</h2>
        <pre id="outputJson"></pre>
    </div>

    <div id="eventToolSection" class="content hidden">
        <button id="getJson">현재 데이터 가져오기</button>
    </div>

    <script>
        function toggleSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content').forEach(section => {
                section.classList.add('hidden');
            });

            // Show the selected section
            document.getElementById(sectionId).classList.remove('hidden');
        }

        // Markdown Converter
        document.getElementById('fileInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const content = e.target.result.replace(/\n/g, '\\n');
                    document.getElementById('outputText').textContent = content;
                };
                reader.readAsText(file);
            }
        });

        // Event JSON Generator
        // ... (Event JSON Generator JavaScript 코드를 여기에 추가) ...
        document.getElementById('generateButton').addEventListener('click', function() {
            const priority = parseInt(document.getElementById('priorityInput').value);
            const bannerImageName = document.getElementById('bannerImageInput').files[0]?.name.split('.')[0];
            const popupImageName = document.getElementById('popupImageInput').files[0]?.name.split('.')[0];
            const useDateTime = document.getElementById('useDateTime').checked;
            const beginDateTime = useDateTime ? document.getElementById('beginDateTimeInput').value + ':00' : '';
            const endDateTime = useDateTime ? document.getElementById('endDateTimeInput').value + ':00' : '';
            const url = document.getElementById('urlInput').value;
            const useAgentAddress = document.getElementById('useAgentAddress').checked;
            const description = document.getElementById('descriptionInput').value;

            const jsonOutput = {
                Priority: priority,
                BannerImageName: bannerImageName,
                PopupImageName: popupImageName,
                UseDateTime: useDateTime,
                BeginDateTime: beginDateTime,
                EndDateTime: endDateTime,
                Url: url,
                UseAgentAddress: useAgentAddress,
                Description: description
            };

            document.getElementById('outputJson').textContent = JSON.stringify(jsonOutput, null, 4);
        });

        // Event JSON Modifier
        // ... (Event JSON Modifier JavaScript 코드를 여기에 추가) ...
        document.getElementById('getJson').addEventListener('click', async function() {
            const response = await fetch('https://raw.githubusercontent.com/planetarium/NineChronicles.LiveAssets/main/Assets/Json/Event.json',
            {
                method: 'GET',
            });
            const json = await response.json();
            const serializedList = json.Banners;
            function generateTable() {
                // creates a <table> element and a <tbody> element
                const tbl = document.createElement("table");
                const tblBody = document.createElement("tbody");

                serializedList.sort((a,b) => a.Priority - b.Priority);
                // creating all cells
                serializedList.forEach(s => {
                    const row = document.createElement("tr");
                    const bannerNameTd = document.createElement("td")
                    bannerNameTd.appendChild(document.createTextNode(`${s.BannerImageName}`))
                    row.appendChild(bannerNameTd);

                    const popupNameTd = document.createElement("td")
                    popupNameTd.appendChild(document.createTextNode(`${s.PopupImageName}`))
                    row.appendChild(popupNameTd);

                    const bannerTd = document.createElement("td")
                    const banner = document.createElement("img")
                    banner.src = `https://raw.githubusercontent.com/planetarium/NineChronicles.LiveAssets/main/Assets/Images/Banner/${s.BannerImageName}.png`
                    bannerTd.appendChild(banner)
                    row.appendChild(bannerTd);

                    const popupTd = document.createElement("td")
                    const popup = document.createElement("img")
                    popup.src = `https://raw.githubusercontent.com/planetarium/NineChronicles.LiveAssets/main/Assets/Images/Notice/${s.PopupImageName}.png`
                    popupTd.appendChild(popup)
                    row.appendChild(popupTd);

                    const beginDateTimeTd = document.createElement("td")
                    beginDateTimeTd.appendChild(document.createTextNode(`${s.BeginDateTime}`))
                    row.appendChild(beginDateTimeTd)

                    const endDateTimeTd = document.createElement("td")
                    endDateTimeTd.appendChild(document.createTextNode(`${s.EndDateTime}`))
                    row.appendChild(endDateTimeTd)

                    const urlTd = document.createElement("td")
                    urlTd.appendChild(document.createTextNode(`${s.Url}`))
                    row.appendChild(urlTd)

                    const descriptionTd = document.createElement("td")
                    descriptionTd.appendChild(document.createTextNode(`${s.Description}`))
                    row.appendChild(descriptionTd)

                    // add the row to the end of the table body
                    tblBody.appendChild(row);
                });

                // put the <tbody> in the <table>
                tbl.appendChild(tblBody);
                tbl.setAttribute("border", "2");

                // appends <table> into <body>
                document.body.appendChild(tbl);
            }
            generateTable()
            serializedList.forEach(s => console.log(s.BannerImageName))
        });
    </script>
</body>
</html>
